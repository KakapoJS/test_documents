# 文件语音识别

## 1. 接口描述

接口请求域名：dev-winner-api.neunit.com:18052
接口请求路径： POST /cloud/asr/v1/file

本接口服务对时长5小时以内的录音文件进行识别，支持同步，异步，回调等方式返回识别结果。
- 支持 wav、mp3、aac、pcm 等音频格式。
- 支持语音 URL 和本地语音文件两种请求方式。语音 URL 的音频时长不能长于5小时，文件大小不超过1GB。本地语音文件调用不能大于5MB。
- 支持回调或轮询的方式获取结果，结果获取请参考 录音文件识别结果查询。

## 2. 输入参数

以下请求参数列表仅列出了接口请求参数。

| 参数名称   | 必选 | 类型    | 描述                                                         |
| :--------- | :--- | :------ | :----------------------------------------------------------- |
| source_type       | 是   | Integer  | 语音数据来源。0：语音 URL；1：语音数据。|
| receive_type | 是   | Integer  | 接受类型。0：同步；1：异步，2：回调。|
| url | 否   | String  | 语音的URL地址，需要公网环境浏览器可下载。当 SourceType 值为 0 时须填写该字段，为 1 时不需要填写。注意：请确保录音文件时长在5个小时之内，否则可能识别失败。请保证文件的下载速度，否则可能下载失败。|
| data | 否   | String  | 语音数据 base64 编码，当 SourceType 值为1时必须填写，为0可不写。音频数据要小于5MB。|
| callback_url | 否   | String | 回调 URL，用户自行搭建的用于接收识别结果的服务URL。|

## 3. 输出参数

| 参数名称   | 类型   | 描述                      |
| :--------- | :----- | :------------------------ |
| rid | String | 本次请求唯一 id |
| code | Integer | 状态码，成功为 0，错误为其他值 | 
| msg | String | 状态信息，成功为 OK，错误为其他信息 | 
| data | Object | 返回数据，成功状态下有值，具体结构见下文 |

### data 参数结构

| 参数名称   | 类型   | 描述                      |
| :--------- | :----- | :------------------------ |
| content | String | 文本内容，ReceiveType 值为 0 时有值。|
| task_id | String | 任务 id，ReceiveType 值为 1 时有值。| 

## 4. 示例

### 示例1 通过语音Url来调用接口

用户通过语音Url的方式异步返回转换结果，请求录音识别服务

#### 输入示例

```json
POST / HTTP/1.1
Host: host
Content-Type: application/json
Path: /cloud/asr/v1/file

{
  "source_type": 0,
  "receive_type": 1,
  "url": "http://xxx/test.wav",
  "data": "",
  "callback_url": ""
}
```



#### 输出示例

```json
{
    "rid": "ab8a260e-3ffe-598a-bbcb-32324bb760d3",
    "code": 0,
    "msg": "OK",
    "data": {
      "content": "这是一个测试样例",
      "task_id": ""
    }
}
```



## 5. 开发者资源

### SDK

云 API 提供了配套的开发工具集（SDK），支持多种编程语言，能更方便的调用 API。
- [Neunit Cloud SDK for Go](https://neunit.coding.net/p/kms/d/cloud-sdk-go/git)


## 6. 错误码

以下仅列出了接口业务逻辑相关的错误码，其他错误码详见 [公共错误码](../error/%E5%85%AC%E5%85%B1%E9%94%99%E8%AF%AF%E7%A0%81.md)。

| 错误码                                    | 描述                                                         |
| :---------------------------------------- | :----------------------------------------------------------- |
| 10101001           | 音频文件 url 获取失败。                                      |
| 10101002           | 参数 url 不能为空。                                         |
| 10101003           | 参数 data 不能为空。                                  |
| 10101004           | 参数 data 解析失败。                                  |
| 10101005           | asr 转义失败，请稍后重试。                                    |

